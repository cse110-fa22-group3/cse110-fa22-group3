<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: front-end/modules/passwordHolder/scripts/main.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: front-end/modules/passwordHolder/scripts/main.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>//main.js
import {
  createPassword,
  readPasswords,
  deletePassword,
  updatePassword,
  queryPasswordInfo,
  readIdCount,
} from "../../../../back-end/passwordHolderAPI.js";
window.addEventListener("DOMContentLoaded", init);

// empty password array for initialization
let passwordArray = [];

/**
 * init handles implementing the javascript code on start
 */
function init() {
  initPage(passwordArray);
}

/**
 * initPage handles the creation of the cards on the page when loaded.
 * @param {Array} array provided by the initialization of the page
 */
function initPage(array) {
  // initialize array with data from localstorage
  array = readPasswords();
  if (array.length == 0) {
    createNoPasswordsMessage();
  } else {
    for (let i = 0; i &lt; array.length; i++) {
      createCard(array[i]);
    }
  }
}

/**
 * createNoPasswordsMessage handles adding a placeholder text if there are no
 * passwords that have been created by the user.
 */
function createNoPasswordsMessage() {
  let passwordList = document.getElementById("password-list");
  let noPasswordsMessage = document.createElement("p");
  noPasswordsMessage.setAttribute("id", "no-elements-present");
  noPasswordsMessage.textContent = "No passwords to show";
  noPasswordsMessage.className = "no-data-message";
  passwordList.appendChild(noPasswordsMessage);
}

/**
 * deleteNoPasswordsMessage handles removing the placeholdertext if there were
 * no passwords present.
 */
function deleteNoPasswordsMessage() {
  let noPasswordsMessage = document.getElementById("no-elements-present");
  if (noPasswordsMessage == null) {
    return;
  }
  noPasswordsMessage.remove();
}

/**
 * createCard handles the creation of a card on the password holder page.
 * It takes care of all button functionalities and data presentation throughout
 * the card element.
 * @param {Object} data which has the information for what should be put in the card
 * through the API
 */
function createCard(data) {
  deleteNoPasswordsMessage();
  let passwordList = document.getElementById("password-list");
  let cardButtonDiv = document.createElement("div");
  cardButtonDiv.setAttribute("class", "input-group");

  let card = document.createElement("password-holder-card");
  let buttonsSpan = document.createElement("span");
  buttonsSpan.setAttribute("class", "input-group-btn");

  let deleteButton = document.createElement("button");
  let editButton = document.createElement("button");

  editButton.setAttribute(
    "class",
    "btn btn-md btn-outline-warning edit-button"
  );
  editButton.setAttribute("id", "password-card-edit-id-" + data["id"]);
  editButton.setAttribute("data-passwordId", data["id"]);
  editButton.setAttribute("data-bs-toggle", "modal");
  editButton.setAttribute("data-bs-target", "#edit-modal");
  let editButtonText = document.createTextNode("Edit");
  editButton.appendChild(editButtonText);

  deleteButton.setAttribute(
    "class",
    "btn btn-md btn-outline-danger delete-button"
  );
  deleteButton.setAttribute("id", "password-card-delete-id-" + data["id"]);
  deleteButton.setAttribute("data-passwordId", data["id"]);
  cardButtonDiv.setAttribute("id", "password-card-div-" + data["id"]);
  let deleteButtonText = document.createTextNode("Delete");
  deleteButton.appendChild(deleteButtonText);

  card.setAttribute("id", "passwordCard" + data["id"]);
  card.setAttribute("data-value", data["id"]);
  card.setAttribute("data-bs-toggle", "modal");
  card.setAttribute("data-bs-target", "#info-modal");
  card.data = data;

  buttonsSpan.appendChild(editButton);
  buttonsSpan.appendChild(deleteButton);
  cardButtonDiv.appendChild(card);
  cardButtonDiv.appendChild(buttonsSpan);
  passwordList.appendChild(cardButtonDiv);

  document
    .getElementById("password-card-delete-id-" + data["id"])
    .addEventListener("click", deletePasswordClick);
  document
    .getElementById("passwordCard" + data["id"])
    .addEventListener("click", openInfoPasswordClick);
  document
    .getElementById("password-card-edit-id-" + data["id"])
    .addEventListener("click", passIdToEditButton);
}

/**
 * passIdToEditButton handles the event in where the edit button is pressed
 * for a specific card. In this situation the edit button will pass the card
 * id to the modal's edit button so we can edit the specific card we are working
 * on.
 */
function passIdToEditButton() {
  let buttonEdit = document.getElementById("edit-password-change");
  buttonEdit.setAttribute("data-passwordId", this.dataset["passwordid"]);
}

/**
 * openInfoPasswordClick handles the event where we press on the card.
 * We then serve the user a modal with the information regarding the username
 * and password credentials for a given shared account.
 */
function openInfoPasswordClick() {
  let info = queryPasswordInfo(parseInt(this["dataset"]["value"]));
  let modalUsernameField = document.getElementById("insert-username-modal");
  let modalPasswordField = document.getElementById("insert-password-modal");
  modalUsernameField.innerText = info.username;
  modalPasswordField.innerText = info.password;
}

/**
 * deletePasswordClick handles the event where we press the delete button
 * for a specific card. In this scenario we take the id associated with the
 * card we pressed the delete for and respond by removing the card from the
 * dom and its information from localStorage.
 */
function deletePasswordClick() {
  let cardToBeDeleted = document.getElementById(
    "password-card-div-" + this.dataset["passwordid"]
  );
  deletePassword(parseInt(this.dataset["passwordid"]));
  cardToBeDeleted.remove();
  if (readPasswords().length == 0) {
    createNoPasswordsMessage();
  }
}

document
  .getElementById("edit-password-change")
  .addEventListener("click", editPasswordForm);

/**
 * editPasswordForm handles the event where we confirm the edit in the edit modal
 * for a given card. This will communicate with the back end update API to fix the
 * localStorage accordingly and update the card to have the proper account name.
 */
function editPasswordForm() {
  let account = document.getElementById("edit-account-field").value;
  let username = document.getElementById("edit-username-field").value;
  let password = document.getElementById("edit-password-field").value;
  let updatedPassword = {
    key: account,
    username: username,
    password: password,
  };
  updatePassword(parseInt(this.dataset["passwordid"]), updatedPassword);
  let card = document.getElementById(
    "passwordCard" + this.dataset["passwordid"]
  );
  card.data = queryPasswordInfo(parseInt(this.dataset["passwordid"]));
  document.getElementById("edit-account-field").value = "";
  document.getElementById("edit-username-field").value = "";
  document.getElementById("edit-password-field").value = "";
}

document
  .getElementById("create-password-change")
  .addEventListener("click", createPasswordForm);

/**
 * createPasswordForm handles the event where we press on the create
 * modal's create button. We will then create a new card and attach it to
 * the DOM aswell as update the localStorage with the new information.
 */
function createPasswordForm() {
  // gather form information
  let account = document.getElementById("create-account-field").value;
  let username = document.getElementById("create-username-field").value;
  let password = document.getElementById("create-password-field").value;
  let newPassword = {
    key: account,
    username: username,
    password: password,
  };
  // call api to update local storage with new creation
  createPassword(newPassword);
  newPassword["id"] = readIdCount() - 1;

  // dynamically create a new card
  createCard(newPassword);

  // clear fields for next button press
  document.getElementById("create-account-field").value = "";
  document.getElementById("create-username-field").value = "";
  document.getElementById("create-password-field").value = "";
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addPayment">addPayment</a></li><li><a href="global.html#addTransaction">addTransaction</a></li><li><a href="global.html#checkDate">checkDate</a></li><li><a href="global.html#clearArchive">clearArchive</a></li><li><a href="global.html#closeChore">closeChore</a></li><li><a href="global.html#createCard">createCard</a></li><li><a href="global.html#createChore">createChore</a></li><li><a href="global.html#createFormHandler">createFormHandler</a></li><li><a href="global.html#createNoPasswordsMessage">createNoPasswordsMessage</a></li><li><a href="global.html#createPassword">createPassword</a></li><li><a href="global.html#createPasswordForm">createPasswordForm</a></li><li><a href="global.html#createRoommate">createRoommate</a></li><li><a href="global.html#createRoommateCard">createRoommateCard</a></li><li><a href="global.html#dataExist">dataExist</a></li><li><a href="global.html#deleteHistory">deleteHistory</a></li><li><a href="global.html#deleteNoPasswordsMessage">deleteNoPasswordsMessage</a></li><li><a href="global.html#deletePassword">deletePassword</a></li><li><a href="global.html#deletePasswordClick">deletePasswordClick</a></li><li><a href="global.html#deleteRoommate">deleteRoommate</a></li><li><a href="global.html#deleteRoommateFromDivider">deleteRoommateFromDivider</a></li><li><a href="global.html#displayRoommateCards">displayRoommateCards</a></li><li><a href="global.html#editFormHandler">editFormHandler</a></li><li><a href="global.html#editPasswordForm">editPasswordForm</a></li><li><a href="global.html#getAssignees">getAssignees</a></li><li><a href="global.html#getAvgContribution">getAvgContribution</a></li><li><a href="global.html#getContribution">getContribution</a></li><li><a href="global.html#getCurrentWeek">getCurrentWeek</a></li><li><a href="global.html#getDebt">getDebt</a></li><li><a href="global.html#getHistoryArray">getHistoryArray</a></li><li><a href="global.html#getLog">getLog</a></li><li><a href="global.html#getRoommate">getRoommate</a></li><li><a href="global.html#getRoommateArray">getRoommateArray</a></li><li><a href="global.html#getRoommateId">getRoommateId</a></li><li><a href="global.html#getRoommateIndex">getRoommateIndex</a></li><li><a href="global.html#getRoommateName">getRoommateName</a></li><li><a href="global.html#getTodaysDate">getTodaysDate</a></li><li><a href="global.html#getTotalContributions">getTotalContributions</a></li><li><a href="global.html#inCharge">inCharge</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initFormHandler">initFormHandler</a></li><li><a href="global.html#initializeList">initializeList</a></li><li><a href="global.html#initializeRoommate">initializeRoommate</a></li><li><a href="global.html#initPage">initPage</a></li><li><a href="global.html#initRoommateAssignment">initRoommateAssignment</a></li><li><a href="global.html#openInfoPasswordClick">openInfoPasswordClick</a></li><li><a href="global.html#passIdToEditButton">passIdToEditButton</a></li><li><a href="global.html#pay">pay</a></li><li><a href="global.html#populateHistory">populateHistory</a></li><li><a href="global.html#processPayment">processPayment</a></li><li><a href="global.html#processTransfer">processTransfer</a></li><li><a href="global.html#queryChore">queryChore</a></li><li><a href="global.html#queryPasswordInfo">queryPasswordInfo</a></li><li><a href="global.html#readChores">readChores</a></li><li><a href="global.html#readIdCount">readIdCount</a></li><li><a href="global.html#readPasswords">readPasswords</a></li><li><a href="global.html#readRoommate">readRoommate</a></li><li><a href="global.html#reevaluateDebt">reevaluateDebt</a></li><li><a href="global.html#removeFromChore">removeFromChore</a></li><li><a href="global.html#reOpenChore">reOpenChore</a></li><li><a href="global.html#setHistoryArray">setHistoryArray</a></li><li><a href="global.html#setRoommateArray">setRoommateArray</a></li><li><a href="global.html#setupPage">setupPage</a></li><li><a href="global.html#storeData">storeData</a></li><li><a href="global.html#transfer">transfer</a></li><li><a href="global.html#updateChore">updateChore</a></li><li><a href="global.html#updateDelHandler">updateDelHandler</a></li><li><a href="global.html#updatePassword">updatePassword</a></li><li><a href="global.html#updateRoommate">updateRoommate</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Sun Dec 04 2022 03:42:13 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
