<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: front-end/modules/roommate-list/js/main.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: front-end/modules/roommate-list/js/main.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>//main.js for roommateList

import {
  createRoommate,
  readRoommate,
  updateRoommate,
  deleteRoommate,
} from "../../../../back-end/roommateListAPI.js";

//page loads, calls init function
window.addEventListener("DOMContentLoaded", init);

/** Starts the program, all our function calls
 *  come from our init function
 */
function init() {
  //load the cards in the page with the current list of roommates
  loadCards(readRoommate());

  //initialize the add button
  addHandler();
}

/** loadCards, reads in our roommates from the local storage and
 *  creates a new element roommate-card for each roommate that will
 *  be present on the page when it is loaded in.
 * @param {Array&lt;object>} roommates an array of roommates
 */
function loadCards(roommates) {
  //find the row element where all of the cards are
  const row = document.querySelector(".row");

  // remove all of the cards except the add button
  while (row.childElementCount > 1) {
    row.removeChild(row.firstElementChild);
  }

  // add a card for each roommate in the list
  roommates.forEach((roommate) => {
    //create the custom element roommate-card
    const card = document.createElement("roommate-card");
    //set the attribute as the roommate's unique id
    card.setAttribute("id", roommate["id"]);
    //set the data of the roommate
    card.data = roommate;
    //insert it as the first card in the row
    row.insertBefore(card, document.querySelector("#new.item"));
  });

  //initialize the update/delete buttons for when any of the cards are clicked
  updateDelHandler();
}

/** addHandler, provides the functionality for showing/hiding the
 *  popup, and submitting the new roommate data. This function should
 *  only be executed once, as there is only one add button.
 */
function addHandler() {
  //node for the add form
  const addForm = document.querySelector("form.add");
  //node for the popup showing the add form
  const addPopup = document.querySelector("#background-1");
  //node for the add button in the popup
  const addBtn = document.querySelector("#new.item");
  //node for the close button in the popup
  const closeBtn = document.getElementById("close-button-1");

  //when submit button is clicked, call the add function
  addForm.addEventListener("submit", add);

  function add(event) {
    //prevent refreshing the page
    event.preventDefault();
    //hide the popup
    addPopup.style.display = "none";
    //create a new roommate using the form data
    createRoommate(new FormData(addForm));
    //clear the entries in the form
    addForm.reset();
    //reload the cards with the new list of roommates
    loadCards(readRoommate());
  }

  // when the add button is clicked, show the popup
  addBtn.onclick = function show() {
    addPopup.style.display = "block";
  };

  // when the close button is clicked, hide the popup
  closeBtn.onclick = function close() {
    addPopup.style.display = "none";
  };
}

/** updateDelHandler, handles when a roommate-card gets deleted or updated. The function
 *  will add the updated roommate list to local storage. Provides the functionality to
 *  show/hide a popup where people can input information for updating or deleting
 *  a roommate. This function should be executed multiple times, occuring when any
 *  CRUD operations occur.
 */
function updateDelHandler() {
  //list of nodes for all of the roommate-card elements
  const cards = document.querySelectorAll("roommate-card");
  //node for the update form
  const updateForm = document.querySelector("form.update");
  //node for the popup showing the update form
  const updatePopup = document.querySelector("#background-2");
  //node for the delete button in the popup
  const delBtn = document.getElementById("delete-button");
  //node for the close button in the popup
  const closeBtn = document.getElementById("close-button-2");

  //creating an event listener for each card
  cards.forEach((card) => {
    card.addEventListener("click", (event) => {
      //getting the list of roommates
      const roommates = readRoommate();
      //getting the id from the element (must do it now before event gets replaced in a different event listener)
      const id = event.target.id;
      //roommate variable
      let roommate;

      //grabbing the roommate with the matching id
      for (let i = 0; i &lt; roommates.length; i++) {
        if (roommates[i].id == event.target.id) {
          roommate = roommates[i];
          break;
        }
      }

      // updating the form HTML to prefill it with the roommate's data
      updateForm.innerHTML = `&lt;fieldset>
				&lt;label for="name">
					Name:
					&lt;input type="text" id="name"  name="name" value = "${roommate.name}" placeholder="First Last" required>
				&lt;/label>
			&lt;/fieldset>
			&lt;fieldset>
				&lt;label for="birthday">
					Birthday:
					&lt;input type="text" id="birthday"  name="birthday" value = "${roommate.birthday}" placeholder="mm/dd/yyyy" pattern="\\d\\d/\\d\\d/\\d\\d\\d\\d" required>
				&lt;/label>
			&lt;/fieldset>
			&lt;fieldset>
				&lt;label for="hobbies">
					Hobbies:
					&lt;input type="text" id="hobbies"  name="hobbies" value = "${roommate.hobbies}" placeholder="hobby, hobby, etc.">
				&lt;/label>
			&lt;/fieldset>
			&lt;fieldset>
				&lt;label for="notes">
					Notes:
					&lt;input type="text" id="notes"  name="notes" value = "${roommate.notes}" placeholder="...">
				&lt;/label>
			&lt;/fieldset>
			&lt;button type="submit" id="save_button">SAVE&lt;/button>`;

      //when submit button is clicked, call the submit function
      updateForm.addEventListener("submit", update);

      function update(event) {
        //prevent refreshing the page
        event.preventDefault();
        //remove this specific card's event listener (important, since all the cards use the same form for updating)
        updateForm.removeEventListener("submit", update);
        //hide the popup
        updatePopup.style.display = "none";
        //update a roommate using the form data and the roommate's id
        updateRoommate(new FormData(updateForm), parseInt(id));
        //reload the cards with the new list of roommates
        loadCards(readRoommate());
      }

      //when a card is clicked, show the popup
      updatePopup.style.display = "block";

      // when the close button is clicked, hide the popup
      closeBtn.onclick = function close() {
        updatePopup.style.display = "none";
        //remove this specific card's event listener (important, since all the cards use the same form for updating)
        updateForm.removeEventListener("submit", update);
      };

      //when the delete button is clicked, hide the popup
      delBtn.onclick = function () {
        updatePopup.style.display = "none";
        //remove this specific card's event listener (not really necessary here, but just in case)
        updateForm.removeEventListener("submit", update);
        //delete the roommate with the matching id
        deleteRoommate(id);
        //reload the cards with the new list of roommates
        loadCards(readRoommate());
      };
    });
  });
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Roommate.html">Roommate</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addHandler">addHandler</a></li><li><a href="global.html#addPayment">addPayment</a></li><li><a href="global.html#addTransaction">addTransaction</a></li><li><a href="global.html#checkDate">checkDate</a></li><li><a href="global.html#clearArchive">clearArchive</a></li><li><a href="global.html#closeChore">closeChore</a></li><li><a href="global.html#createCard">createCard</a></li><li><a href="global.html#createChore">createChore</a></li><li><a href="global.html#createFormHandler">createFormHandler</a></li><li><a href="global.html#createNoPasswordsMessage">createNoPasswordsMessage</a></li><li><a href="global.html#createPassword">createPassword</a></li><li><a href="global.html#createPasswordForm">createPasswordForm</a></li><li><a href="global.html#createRoommate">createRoommate</a></li><li><a href="global.html#createRoommateCard">createRoommateCard</a></li><li><a href="global.html#dataExist">dataExist</a></li><li><a href="global.html#deleteHistory">deleteHistory</a></li><li><a href="global.html#deleteNoPasswordsMessage">deleteNoPasswordsMessage</a></li><li><a href="global.html#deletePassword">deletePassword</a></li><li><a href="global.html#deletePasswordClick">deletePasswordClick</a></li><li><a href="global.html#deleteRoommate">deleteRoommate</a></li><li><a href="global.html#deleteRoommateFromDivider">deleteRoommateFromDivider</a></li><li><a href="global.html#displayRoommateCards">displayRoommateCards</a></li><li><a href="global.html#editFormHandler">editFormHandler</a></li><li><a href="global.html#editPasswordForm">editPasswordForm</a></li><li><a href="global.html#getAssignees">getAssignees</a></li><li><a href="global.html#getAvgContribution">getAvgContribution</a></li><li><a href="global.html#getContribution">getContribution</a></li><li><a href="global.html#getCurrentWeek">getCurrentWeek</a></li><li><a href="global.html#getDebt">getDebt</a></li><li><a href="global.html#getHistoryArray">getHistoryArray</a></li><li><a href="global.html#getLog">getLog</a></li><li><a href="global.html#getRoommate">getRoommate</a></li><li><a href="global.html#getRoommateArray">getRoommateArray</a></li><li><a href="global.html#getRoommateId">getRoommateId</a></li><li><a href="global.html#getRoommateIndex">getRoommateIndex</a></li><li><a href="global.html#getRoommateName">getRoommateName</a></li><li><a href="global.html#getTodaysDate">getTodaysDate</a></li><li><a href="global.html#getTotalContributions">getTotalContributions</a></li><li><a href="global.html#inCharge">inCharge</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initializeList">initializeList</a></li><li><a href="global.html#initializeRoommate">initializeRoommate</a></li><li><a href="global.html#initPage">initPage</a></li><li><a href="global.html#initRoommateAssignment">initRoommateAssignment</a></li><li><a href="global.html#loadCards">loadCards</a></li><li><a href="global.html#openInfoPasswordClick">openInfoPasswordClick</a></li><li><a href="global.html#passIdToEditButton">passIdToEditButton</a></li><li><a href="global.html#pay">pay</a></li><li><a href="global.html#populateHistory">populateHistory</a></li><li><a href="global.html#processPayment">processPayment</a></li><li><a href="global.html#processTransfer">processTransfer</a></li><li><a href="global.html#queryChore">queryChore</a></li><li><a href="global.html#queryPasswordInfo">queryPasswordInfo</a></li><li><a href="global.html#readChores">readChores</a></li><li><a href="global.html#readIdCount">readIdCount</a></li><li><a href="global.html#readPasswords">readPasswords</a></li><li><a href="global.html#readRoommate">readRoommate</a></li><li><a href="global.html#reevaluateDebt">reevaluateDebt</a></li><li><a href="global.html#removeFromChore">removeFromChore</a></li><li><a href="global.html#reOpenChore">reOpenChore</a></li><li><a href="global.html#setHistoryArray">setHistoryArray</a></li><li><a href="global.html#setRoommateArray">setRoommateArray</a></li><li><a href="global.html#setupPage">setupPage</a></li><li><a href="global.html#storeData">storeData</a></li><li><a href="global.html#transfer">transfer</a></li><li><a href="global.html#updateChore">updateChore</a></li><li><a href="global.html#updateDelHandler">updateDelHandler</a></li><li><a href="global.html#updatePassword">updatePassword</a></li><li><a href="global.html#updateRoommate">updateRoommate</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Sun Dec 04 2022 20:43:11 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
